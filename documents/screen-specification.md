# 画面仕様書 - 会話ダッシュ

## 📱 画面一覧

| 画面 ID | 画面名                       | 説明                                             |
| ------- | ---------------------------- | ------------------------------------------------ |
| SC-01   | ホーム画面                   | アプリのトップ画面。プレイ開始や統計確認への導線 |
| SC-02   | モード＆キャラクター選択画面 | モードと会話相手の AI キャラを選択               |
| SC-03   | 会話プレイ画面               | メインのゲームプレイ画面                         |
| SC-04   | リザルト画面                 | プレイ結果と評価の表示                           |
| SC-05   | 統計・成長画面               | プレイヤーの成長記録を表示                       |
| SC-06   | 設定画面                     | アプリ全体の設定とゲーム設定                     |

---

## 🔄 画面遷移図

```
┌─────────────────┐
│  SC-01: ホーム   │
│   画面          │
└────┬────────────┘
     │
     ├──「プレイ開始」────→ SC-02: モード＆キャラ選択画面
     │                           │
     │                           ↓
     │                      SC-03: 会話プレイ画面
     │                           │
     │                           ↓
     │                      SC-04: リザルト画面
     │                           │
     │                           ├──「もう一度」───→ SC-02へ戻る
     │                           └──「ホームへ」───→ SC-01へ戻る
     │
     ├──「成長記録」────→ SC-05: 統計・成長画面
     │
     └──「設定」────────→ SC-06: 設定画面
```

---

## 📄 各画面の詳細仕様

### SC-01: ホーム画面

#### 目的

- アプリの顔となる画面
- プレイヤーのモチベーションを高める

#### 画面要素

```
┌─────────────────────────────────────┐
│         会話ダッシュ 💬⚡️             │
├─────────────────────────────────────┤
│                                     │
│   ┌──────────────────────────┐    │
│   │  現在のレベル: Lv.5       │    │
│   │  トーク忍者               │    │
│   │  ─────────────────────    │    │
│   │  連続ログイン: 3日        │    │
│   └──────────────────────────┘    │
│                                     │
│   ┌────────────────────────┐      │
│   │    🎮 プレイ開始        │      │
│   └────────────────────────┘      │
│                                     │
│   ┌────────────────────────┐      │
│   │    📈 成長記録          │      │
│   └────────────────────────┘      │
│                                     │
│   ┌────────────────────────┐      │
│   │    ⚙️  設定             │      │
│   └────────────────────────┘      │
│                                     │
│   今日のメッセージ:                 │
│   「昨日よりテンポ速くなってるよ！」│
│                                     │
└─────────────────────────────────────┘
```

#### 主要コンポーネント

- **プレイヤー情報カード**
  - レベル表示
  - 称号表示
  - 連続ログイン日数
- **アクションボタン**
  - プレイ開始ボタン（Primary CTA）
  - 成長記録ボタン
  - 設定ボタン
- **モチベーションメッセージ**
  - AI による励ましや前回からの成長ポイント

#### インタラクション

- 「プレイ開始」→ SC-02 へ遷移
- 「成長記録」→ SC-05 へ遷移
- 「設定」→ SC-06 へ遷移

---

### SC-02: モード＆キャラクター選択画面

#### 目的

- プレイヤーの目的や気分に合わせてモードとキャラクターを選択
- 選択したら即座にプレイ開始できるシンプルな流れ

#### 画面要素

```
┌─────────────────────────────────────┐
│  ← プレイ準備                        │
├─────────────────────────────────────┤
│                                     │
│  【モード選択】                      │
│                                     │
│  ┌────────────────────────┐       │
│  │ 👋 初対面チャレンジ     │       │
│  │ はじめまして系の雑談     │       │
│  │ 難易度: ★☆☆          │       │
│  └────────────────────────┘       │
│                                     │
│  ┌────────────────────────┐       │
│  │ 💬 雑談スプリント       │       │
│  │ テーマトークで会話練習   │       │
│  │ 難易度: ★★☆          │       │
│  └────────────────────────┘       │
│                                     │
│  ┌────────────────────────┐       │
│  │ 😅 ピンチ返し           │       │
│  │ 気まずいシーンを克服     │       │
│  │ 難易度: ★★★          │       │
│  └────────────────────────┘       │
│                                     │
│  ┌────────────────────────┐       │
│  │ 🔥 フリートークHELL     │       │
│  │ 制限時間3秒の超反射練習  │       │
│  │ 難易度: ★★★          │       │
│  └────────────────────────┘       │
│                                     │
│  ──────────────────────          │
│                                     │
│  【会話相手を選択】                  │
│                                     │
│  ┌──────────┐  ┌──────────┐      │
│  │   🧑‍💼    │  │   🎨     │      │
│  │ 真面目くん │  │ 明るい女子│      │
│  │ ロジカルで │  │ リアクション│    │
│  │   固め    │  │  ノリ重視 │      │
│  └──────────┘  └──────────┘      │
│                                     │
│  ┌──────────┐  ┌──────────┐      │
│  │   🤓     │  │   😏     │      │
│  │オタク仲間│  │ 冷静タイプ│      │
│  │マニアック│  │ ツッコミ少 │      │
│  │  な話題  │  │  難易度高 │      │
│  └──────────┘  └──────────┘      │
│                                     │
│  選択中: 雑談スプリント × 真面目くん │
│                                     │
│  ┌────────────────────────┐       │
│  │      スタート！          │       │
│  └────────────────────────┘       │
│                                     │
└─────────────────────────────────────┘
```

#### 主要コンポーネント

- **モードカード**（4 種類）
  - モード名とアイコン
  - 簡単な説明文
  - 難易度表示
  - ベストスコア表示（過去にプレイ済みの場合）
  - 選択状態の表示
- **キャラクターカード**（4 種類）
  - キャラクターアバター
  - 名前
  - 特徴の説明
  - 選択状態の表示
- **選択中の組み合わせ表示**
- **スタートボタン**（両方選択時のみ有効化）
- **ヘッダー**
  - 戻るボタン

#### インタラクション

- モードカードをタップ → モード選択状態に
- キャラクターカードをタップ → キャラ選択状態に
- スタートボタン → SC-03 へ遷移（両方選択済みの場合のみ）
- 戻るボタン → SC-01 へ戻る

#### データ構造

```typescript
type Mode = {
  id: "first-meeting" | "casual-sprint" | "pinch-recovery" | "freetalk-hell";
  name: string;
  description: string;
  icon: string;
  difficulty: 1 | 2 | 3;
  timeLimit: number; // 秒
  defaultTurns: number;
};

type Character = {
  id: "serious" | "cheerful" | "otaku" | "calm";
  name: string;
  avatar: string;
  description: string;
  personality: {
    responseStyle: "logical" | "emotional" | "enthusiastic" | "minimal";
    reactionFrequency: "low" | "medium" | "high";
    topicPreference: string[];
  };
};

type GameSetup = {
  mode: Mode;
  character: Character;
};
```

---

### SC-03: 会話プレイ画面（メイン）

#### 目的

- 実際の会話練習を行うメイン画面
- リアルタイムでのフィードバック

#### 画面要素

```
┌─────────────────────────────────────┐
│  ⏸️  ターン 3/10     ❌             │
├─────────────────────────────────────┤
│                                     │
│  😊 真面目くん                      │
│  現在の気分: 楽しそう                │
│                                     │
│  ┌────────────────────────┐       │
│  │ 昨日寝不足でさ〜         │       │
│  │ [AI - 13:24]            │       │
│  └────────────────────────┘       │
│                                     │
│  ┌────────────────────────┐       │
│  │ うわ、それ俺も！         │       │
│  │ 昨日3時まで起きてたわ    │       │
│  │             [You - 13:24]│      │
│  └────────────────────────┘       │
│                                     │
│  ┌────────────────────────┐       │
│  │ マジ！？何してたの？笑   │       │
│  │ [AI - 13:24]            │       │
│  └────────────────────────┘       │
│                                     │
│  ┌──────────────────────┐         │
│  │  ⏱️ ████████░░  5秒   │         │
│  └──────────────────────┘         │
│                                     │
│  ┌────────────────────────┐       │
│  │ あなたの返答を入力...    │       │
│  │                   [送信] │       │
│  └────────────────────────┘       │
│                                     │
│  💬 トークコンボ × 3！               │
│                                     │
└─────────────────────────────────────┘
```

#### 主要コンポーネント

- **ヘッダー**
  - 一時停止ボタン
  - ターン数表示
  - 終了ボタン
- **キャラクター情報**
  - アバター表示
  - 現在の気分（感情状態）
- **会話エリア**
  - メッセージバブル（AI/プレイヤー）
  - タイムスタンプ
  - スクロール可能
- **タイマーバー**
  - 残り時間の視覚的表示
  - 色変化（緑 → 黄 → 赤）
- **入力エリア**
  - テキストインプット
  - 送信ボタン
- **フィードバック表示**
  - コンボ表示
  - 即座の反応（Good!など）

#### 状態管理

```typescript
type ConversationState = {
  currentTurn: number;
  maxTurns: number;
  timeLimit: number;
  remainingTime: number;
  messages: Message[];
  combo: number;
  aiMood: "happy" | "neutral" | "bored" | "surprised";
  isPaused: boolean;
};

type Message = {
  id: string;
  sender: "ai" | "player";
  content: string;
  timestamp: Date;
  responseTime?: number; // プレイヤーメッセージの場合
  score?: MessageScore; // 評価スコア
};

type MessageScore = {
  speed: number; // 0-100
  naturalness: number;
  empathy: number;
  topicExpansion: number;
  emotion: number;
};
```

#### インタラクション

- メッセージ送信 → AI が即座に返答 → 次のターンへ
- タイムアウト → 「...（気まずい演出）」→ 次のターンへ
- 最終ターン終了 → SC-04 へ遷移
- 終了ボタン → 確認ダイアログ → SC-01 へ戻る

#### 演出

- **タイマー演出**
  - 残り 3 秒で赤色に変化
  - 残り 1 秒で点滅
- **コンボ演出**
  - 3 ターン連続で高評価 → 「トークコンボ！」アニメーション
- **気まずい演出**
  - タイムアウト時に画面が暗転
  - AI の表情が困惑
- **AI の表情変化**
  - プレイヤーの返答に応じて表情が変化

---

### SC-04: リザルト画面

#### 目的

- プレイ結果の総合評価を表示
- 次のアクションへの導線

#### 画面要素

```
┌─────────────────────────────────────┐
│           リザルト 🎉               │
├─────────────────────────────────────┤
│                                     │
│         総合スコア                   │
│         ─────────                   │
│           ★ 85点 ★                │
│                                     │
│  ┌────────────────────────┐       │
│  │ 🗣️ 反応速度    ████████ 90 │   │
│  │ 💬 自然さ      ███████░ 85 │   │
│  │ 🎯 共感力      ██████░░ 75 │   │
│  │ 🤝 話題展開力  ████████ 90 │   │
│  │ 😂 感情表現    ███████░ 80 │   │
│  └────────────────────────┘       │
│                                     │
│  真面目くんからのコメント:           │
│  ┌────────────────────────┐       │
│  │ 「テンポ最高！でもちょっと  │   │
│  │  話題広げるの忘れたね😏」  │   │
│  └────────────────────────┘       │
│                                     │
│  🎖️ 新しい称号を獲得！              │
│  「リアクション忍者」                │
│                                     │
│  レベルアップ！ Lv.5 → Lv.6         │
│                                     │
│  ┌────────────────────────┐       │
│  │      もう一度            │       │
│  └────────────────────────┘       │
│                                     │
│  ┌────────────────────────┐       │
│  │      ホームへ            │       │
│  └────────────────────────┘       │
│                                     │
└─────────────────────────────────────┘
```

#### 主要コンポーネント

- **総合スコア表示**
  - 大きく表示（アニメーション）
- **各項目の評価グラフ**
  - 5 項目のバーチャート
  - 数値とビジュアルで表示
- **AI コメント**
  - キャラクターからの一言
  - ポジティブなフィードバック + 改善点
- **獲得報酬**
  - 新しい称号（該当する場合）
  - レベルアップ（該当する場合）
- **アクションボタン**
  - もう一度ボタン
  - ホームへボタン

#### データ構造

```typescript
type Result = {
  sessionId: string;
  mode: string;
  character: string;
  totalScore: number;
  scores: {
    speed: number;
    naturalness: number;
    empathy: number;
    topicExpansion: number;
    emotion: number;
  };
  aiComment: string;
  newAchievements: Achievement[];
  levelUp: {
    before: number;
    after: number;
  } | null;
  conversation: Message[];
  playedAt: Date;
};
```

#### インタラクション

- もう一度ボタン → SC-02 へ遷移（同じモードで再プレイ）
- ホームへボタン → SC-01 へ遷移

---

### SC-05: 統計・成長画面

#### 目的

- プレイヤーの成長記録を可視化
- モチベーション維持

#### 画面要素

```
┌─────────────────────────────────────┐
│  ← 成長記録                          │
├─────────────────────────────────────┤
│                                     │
│  あなたの成長 📈                     │
│                                     │
│  ┌────────────────────────┐       │
│  │  現在のレベル: Lv.6      │       │
│  │  次のレベルまで: 450 XP  │       │
│  │  ████████░░░░ 60%       │       │
│  └────────────────────────┘       │
│                                     │
│  平均スコア推移（過去7日）            │
│  ┌────────────────────────┐       │
│  │     *                   │       │
│  │    * *                  │       │
│  │   *   * *               │       │
│  │  *      *  *            │       │
│  │ ────────────────        │       │
│  │ 16 17 18 19 20 21 22    │       │
│  └────────────────────────┘       │
│                                     │
│  獲得済み称号: 5個 🎖️               │
│  ┌──────┐ ┌──────┐ ┌──────┐    │
│  │リアク │ │トーク │ │気まず │    │
│  │ション │ │マスタ │ │さ克服 │    │
│  │ 忍者  │ │ー     │ │       │    │
│  └──────┘ └──────┘ └──────┘    │
│                                     │
│  総プレイ回数: 23回                 │
│  総プレイ時間: 2時間15分            │
│  平均反応速度: 3.2秒                │
│                                     │
└─────────────────────────────────────┘
```

#### 主要コンポーネント

- **レベル進捗バー**
  - 現在のレベル
  - 次レベルまでの経験値
- **スコア推移グラフ**
  - 過去 7 日間の平均スコア
  - 折れ線グラフ
- **称号コレクション**
  - 獲得済み称号の一覧
  - 未獲得のものは？マークで表示
- **統計情報**
  - 総プレイ回数
  - 総プレイ時間
  - 平均反応速度
  - モード別の成績

#### インタラクション

- 戻るボタン → SC-01 へ戻る
- 称号をタップ → 称号詳細モーダル表示

---

### SC-06: 設定画面

#### 目的

- アプリ全体の設定とゲームプレイの設定を管理
- デフォルトのプレイ設定をカスタマイズ

#### 画面要素

```
┌─────────────────────────────────────┐
│  ← 設定                              │
├─────────────────────────────────────┤
│                                     │
│  ゲーム設定                          │
│                                     │
│  デフォルトターン数:                 │
│  ○ 5ターン  ● 10ターン  ○ 15ターン │
│                                     │
│  デフォルト制限時間（1ターンあたり）:│
│  ┌────────────────────────┐       │
│  │  [====●====] 5秒        │       │
│  └────────────────────────┘       │
│  3秒 ←→ 10秒                       │
│                                     │
│  入力方法:                          │
│  ● テキスト入力                     │
│  ○ 音声入力（未実装）               │
│                                     │
│  ──────────────────────            │
│                                     │
│  一般設定                            │
│                                     │
│  サウンド                            │
│  [==========●==]  70%              │
│                                     │
│  バイブレーション                    │
│  ● オン  ○ オフ                     │
│                                     │
│  通知                                │
│  ● 毎日リマインダー（20:00）        │
│  ○ オフ                             │
│                                     │
│  ──────────────────────            │
│                                     │
│  アカウント                          │
│                                     │
│  プロフィール編集                    │
│  >                                  │
│                                     │
│  データをエクスポート                │
│  >                                  │
│                                     │
│  ──────────────────────            │
│                                     │
│  その他                              │
│                                     │
│  利用規約                            │
│  >                                  │
│                                     │
│  プライバシーポリシー                │
│  >                                  │
│                                     │
│  バージョン: 1.0.0                  │
│                                     │
└─────────────────────────────────────┘
```

#### 主要コンポーネント

- **ゲーム設定**
  - デフォルトターン数選択（ラジオボタン）
  - デフォルト制限時間スライダー
  - 入力方法選択（トグル）
- **サウンド設定**
  - 音量スライダー
- **バイブレーション設定**
  - トグルスイッチ
- **通知設定**
  - リマインダーのオン/オフ
  - 時間設定
- **アカウント設定**
  - プロフィール編集リンク
  - データエクスポート
- **その他**
  - 利用規約
  - プライバシーポリシー
  - バージョン情報

#### インタラクション

- 戻るボタン → SC-01 へ戻る
- 各設定項目の変更 → 即座に保存
- ゲーム設定の変更 → 次回プレイ時から反映

---

## 🎨 共通 UI 要素

### デザイントーン

- **カラースキーム**

  - Primary: 鮮やかな青（#3B82F6）
  - Secondary: オレンジ（#F59E0B）
  - Success: 緑（#10B981）
  - Warning: 黄色（#FCD34D）
  - Danger: 赤（#EF4444）
  - Neutral: グレー系統

- **タイポグラフィ**
  - 見出し: 太めのゴシック体
  - 本文: 読みやすい丸ゴシック
  - サイズ: 十分な可読性を確保

### アニメーション

- ページ遷移: スライドイン/アウト（300ms）
- ボタン: ホバー時に軽く拡大
- タイマー: 色変化とパルスエフェクト
- スコア表示: カウントアップアニメーション

### レスポンシブ対応

- モバイルファースト設計
- タブレット・デスクトップでも快適に使用可能
- 縦持ち・横持ち両対応

---

## 📱 技術実装メモ

### Next.js App Router 構成案

```
src/app/
├── page.tsx                    # SC-01: ホーム
├── setup/
│   └── page.tsx                # SC-02: モード＆キャラ選択
├── play/
│   └── page.tsx                # SC-03: プレイ
├── result/
│   └── page.tsx                # SC-04: リザルト
├── stats/
│   └── page.tsx                # SC-05: 統計
└── settings/
    └── page.tsx                # SC-06: 設定
```

### 状態管理

- URL State: モード、キャラクター選択など
- Client State: プレイ中の会話、タイマー
- Server State: ユーザーデータ、スコア履歴
- Local Storage: 設定情報

### データフロー

```
User Action → Client Component → Server Action → AI API → Response → UI Update
```

---

## ✅ チェックリスト

- [x] 各画面のワイヤーフレーム確認
- [x] 画面遷移の流れに問題がないか
- [x] ユーザビリティの観点でチェック（モード＆キャラ選択を統合してスムーズに）
- [x] 実装可能性の確認
- [x] デザインシステムの統一性確認
- [x] 画面数の最適化（8 画面 → 6 画面）

## 📝 変更履歴

### v1.1 - 画面統合とシンプル化

- SC-02（モード選択）と SC-03（キャラ選択）を統合
- SC-04（難易度・設定）を削除し、SC-06（設定画面）に統合
- 全体で 8 画面から 6 画面へスリム化
- 選択からプレイまでの導線を短縮
- 企業向けクローズド公開を想定した設計に最適化
